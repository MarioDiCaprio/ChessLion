{"ast":null,"code":"var _jsxFileName = \"/home/mario/Desktop/ChessLion/client/src/views/components/board/lionChessboard.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport Chess from 'chess.js';\nimport { getPieceStyle } from './style';\nimport MoveHistory from './history';\nimport Pgn from '../../../utils/pgn/pgnParser';\nimport './lionChessboard.scss';\n/**\n * This interface contains all the props for the 'LionChessboard' component.\n */\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\n/**\n * This component displays a chessboard. For info about the props, refer to the\n * interface 'LionCHessboardProps'.\n * @param {LionChessboardProps} props The props for the chessboard\n * @returns The JSX that display the chessboard\n */\nconst LionChessboard = _ref => {\n  _s();\n\n  let {\n    legalMoves = true,\n    fen = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\n    pieceStyle = 'fresca',\n    showHistory = false,\n    showHistoryButtons = false,\n    pgn = undefined,\n    size = 500\n  } = _ref;\n  // @ts-ignore\n  const [game, setGame] = useState(Chess(fen));\n  const [fenHistory] = useState([]);\n  const [gamePgn, setGamePgn] = useState(new Pgn(pgn));\n  const [selectedMoveIndex, setSelectedMoveIndex] = useState([-1, 0]); // legal moves only\n\n  function onPieceDrop(square1, square2) {\n    let move = game.move({\n      from: square1,\n      to: square2,\n      promotion: 'q'\n    });\n\n    if (move !== null) {\n      fenHistory.push(game.fen());\n      setGame({ ...game\n      });\n      gamePgn.addMove({\n        move: move.san\n      });\n      setGamePgn({ ...gamePgn\n      });\n      selectNextMove();\n      return true;\n    } else {\n      return false;\n    }\n  } // gets the key of the currently selected move in the move history\n\n\n  function getSelectedMove() {\n    const [round, side] = selectedMoveIndex;\n    return round + 1 + (side === 0 ? 'w' : 'b');\n  }\n\n  function selectMove(round, side) {\n    if (round >= 0 && round < gamePgn.moves.length) {\n      setSelectedMoveIndex([round, side]); // @ts-ignore\n\n      setGame(Chess(fenHistory[2 * round - 1 + side]));\n    }\n  } // selects next move in the move history\n\n\n  function selectNextMove() {\n    const [round, side] = selectedMoveIndex;\n    if (side === 0) selectMove(round, 1);else selectMove(round + 1, 0);\n  } // selects previous move in the move history\n\n\n  function selectPreviousMove() {\n    const [round, side] = selectedMoveIndex;\n    if (side === 1) selectMove(round, 0);else selectMove(round - 1, 1);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"hstack gap-3\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vstack gap-2\",\n      style: {\n        width: size,\n        height: size\n      },\n      children: [/*#__PURE__*/_jsxDEV(Chessboard, {\n        onPieceDrop: legalMoves ? onPieceDrop : undefined,\n        position: game.fen(),\n        customPieces: getPieceStyle(pieceStyle),\n        customBoardStyle: {\n          borderRadius: '7px'\n        },\n        boardWidth: size,\n        animationDuration: 100\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }, this), showHistoryButtons && /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"history-buttons-div\",\n        className: \"btn-group d-flex justify-content-between\",\n        role: \"group\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: selectPreviousMove,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-caret-left-fill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: selectNextMove,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-caret-right-fill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }, this), showHistory && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: size * 0.65,\n        minHeight: size,\n        maxHeight: size,\n        overflowY: 'scroll',\n        overflowX: 'hidden'\n      },\n      children: /*#__PURE__*/_jsxDEV(MoveHistory, {\n        pgn: gamePgn,\n        selectedMoveKey: getSelectedMove(),\n        onMoveClicked: (round, side) => selectMove(round, side)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 9\n  }, this);\n};\n\n_s(LionChessboard, \"9XE3vKQrudmk+lIrCTv97pYGOy4=\");\n\n_c = LionChessboard;\nexport default LionChessboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"LionChessboard\");","map":{"version":3,"sources":["/home/mario/Desktop/ChessLion/client/src/views/components/board/lionChessboard.tsx"],"names":["React","useState","Chessboard","Chess","getPieceStyle","MoveHistory","Pgn","LionChessboard","legalMoves","fen","pieceStyle","showHistory","showHistoryButtons","pgn","undefined","size","game","setGame","fenHistory","gamePgn","setGamePgn","selectedMoveIndex","setSelectedMoveIndex","onPieceDrop","square1","square2","move","from","to","promotion","push","addMove","san","selectNextMove","getSelectedMove","round","side","selectMove","moves","length","selectPreviousMove","width","height","borderRadius","minHeight","maxHeight","overflowY","overflowX"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport Chess, { Square } from 'chess.js';\nimport { getPieceStyle, PieceStyle } from './style';\nimport MoveHistory from './history';\nimport Pgn, { PgnObject } from '../../../utils/pgn/pgnParser';\nimport './lionChessboard.scss';\n\n\n/**\n * This interface contains all the props for the 'LionChessboard' component.\n */\ninterface LionChessboardProps {\n    /** The FEN position of the board */\n    fen?: string;\n    /** Whether only legal moves should be allowed */\n    legalMoves?: boolean;\n    /** The style of the pieces */\n    pieceStyle?: PieceStyle;\n    /** Whether to show the move history */\n    showHistory?: boolean;\n    /** Whether to show the 'next move' and 'previous move' buttons for the move history */\n    showHistoryButtons?: boolean;\n    /** An optional PGN game */\n    pgn?: string;\n    /** The size of the board in pixels */\n    size?: number;\n}\n\n/**\n * This component displays a chessboard. For info about the props, refer to the\n * interface 'LionCHessboardProps'.\n * @param {LionChessboardProps} props The props for the chessboard\n * @returns The JSX that display the chessboard\n */\nconst LionChessboard: React.FC<LionChessboardProps> = ({\n        legalMoves = true,\n        fen = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\n        pieceStyle = 'fresca',\n        showHistory = false,\n        showHistoryButtons = false,\n        pgn = undefined,\n        size = 500,\n    }: LionChessboardProps) => {\n\n    // @ts-ignore\n    const [game, setGame] = useState( Chess(fen) );\n    const [fenHistory, ] = useState< Array<string> >([]);\n    const [gamePgn, setGamePgn] = useState<Pgn>( new Pgn(pgn) )\n    const [selectedMoveIndex, setSelectedMoveIndex] = useState<[number, 0 | 1]>([-1, 0]);\n\n    // legal moves only\n    function onPieceDrop(square1: Square, square2: Square): boolean {\n        let move = game.move({ from: square1, to: square2, promotion: 'q' });\n        if (move !== null) {\n            fenHistory.push(game.fen());\n            setGame({...game})\n            gamePgn.addMove({ move: move.san });\n            setGamePgn({...gamePgn})\n            selectNextMove();\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    // gets the key of the currently selected move in the move history\n    function getSelectedMove(): string {\n        const [round, side] = selectedMoveIndex;\n        return (round + 1) + (side===0? 'w' : 'b');\n    }\n\n    function selectMove(round: number, side: 0 | 1): void {\n        if (round >= 0 && round < gamePgn.moves.length) {\n            setSelectedMoveIndex([round, side]);\n            // @ts-ignore\n            setGame( Chess(fenHistory[2 * round - 1 + side]) );\n        }\n    }\n\n    // selects next move in the move history\n    function selectNextMove(): void {\n        const [round, side] = selectedMoveIndex;\n        if (side === 0)\n            selectMove(round, 1);\n        else\n            selectMove(round + 1, 0);\n    }\n\n    // selects previous move in the move history\n    function selectPreviousMove(): void {\n        const [round, side] = selectedMoveIndex;\n        if (side === 1)\n            selectMove(round, 0);\n        else\n            selectMove(round - 1, 1);\n    }\n\n    return (\n        <div className=\"hstack gap-3\">\n            <div className=\"vstack gap-2\" style={{width: size, height: size}}>\n                <Chessboard\n                onPieceDrop={ legalMoves? onPieceDrop : undefined }\n                position={ game.fen() }\n                customPieces={ getPieceStyle(pieceStyle) }\n                customBoardStyle={{borderRadius: '7px'}}\n                boardWidth={size}\n                animationDuration={100}\n                />\n                {\n                    showHistoryButtons &&\n                    <div id=\"history-buttons-div\" className=\"btn-group d-flex justify-content-between\" role=\"group\">\n                        <button className=\"btn\" onClick={selectPreviousMove}>\n                            <i className=\"bi bi-caret-left-fill\"></i>\n                        </button>\n                        <button className=\"btn\" onClick={selectNextMove}>\n                            <i className=\"bi bi-caret-right-fill\"></i>\n                        </button>\n                    </div>\n                }\n            </div>\n            {\n                showHistory &&\n                <div style={{\n                    width: size * 0.65,\n                    minHeight: size,\n                    maxHeight: size,\n                    overflowY: 'scroll',\n                    overflowX: 'hidden',\n                }}>\n                    <MoveHistory\n                    pgn={gamePgn}\n                    selectedMoveKey={getSelectedMove()}\n                    onMoveClicked={(round, side) => selectMove(round, side)}\n                    />\n                </div>\n            }\n        </div>\n    );\n}\n\nexport default LionChessboard;\n"]},"metadata":{},"sourceType":"module"}