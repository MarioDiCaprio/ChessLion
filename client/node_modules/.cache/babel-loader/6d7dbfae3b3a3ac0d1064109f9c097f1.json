{"ast":null,"code":"var _jsxFileName = \"/home/mario/Desktop/ChessLion/client/src/views/components/board/lionChessboard.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport Chess from 'chess.js';\nimport { getPieceStyle } from './style';\nimport MoveHistory from './history';\nimport Pgn from '../../../utils/pgn/pgnParser';\nimport './lionChessboard.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction generateFensFromPgn(pgn, fen) {\n  // @ts-ignore\n  const game = Chess(fen);\n  const result = [];\n\n  for (let move of pgn.moves) {\n    const round = ['', ''];\n\n    for (let m of move) {\n      if (m.move !== undefined) {\n        game.move(m.move);\n        round.push(game.fen());\n      }\n    }\n\n    result.push(round);\n  }\n\n  return result;\n}\n/**\n * This interface contains all the props for the 'LionChessboard' component.\n */\n\n\n/**\n * This component displays a chessboard. For info about the props, refer to the\n * interface 'LionCHessboardProps'.\n * @param {LionChessboardProps} props The props for the chessboard\n * @returns The JSX that display the chessboard\n */\nconst LionChessboard = _ref => {\n  _s();\n\n  let {\n    legalMoves = true,\n    fen = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\n    pieceStyle = 'fresca',\n    showHistory = false,\n    showHistoryButtons = false,\n    pgn = undefined,\n    size = 500\n  } = _ref;\n  // @ts-ignore\n  const [game, setGame] = useState(Chess(fen));\n  const [gamePgn, setGamePgn] = useState(new Pgn(pgn));\n  const [selectedMoveIndex, setSelectedMoveIndex] = useState([-1, 1]); // legal moves only\n\n  function onPieceDrop(square1, square2) {\n    let move = game.move({\n      from: square1,\n      to: square2,\n      promotion: 'q'\n    });\n\n    if (move !== null) {\n      setGame({ ...game\n      });\n      gamePgn.addMove({\n        move: move.san\n      });\n      setGamePgn({ ...gamePgn\n      });\n      selectNextMove();\n      return true;\n    } else {\n      return false;\n    }\n  } // gets the key of the currently selected move in the move history\n\n\n  function getSelectedMove() {\n    const [round, side] = selectedMoveIndex;\n    return round + 1 + (side === 0 ? 'w' : 'b');\n  }\n\n  function getSelectedFen() {\n    const [round, side] = selectedMoveIndex;\n    if (round === -1) return fen;\n    const fens = generateFensFromPgn(gamePgn, fen);\n    return fens[round][side];\n  }\n\n  function selectMove(round, side) {\n    if (round >= 0 && round < gamePgn.moves.length) {\n      setSelectedMoveIndex([round, side]); // @ts-ignore\n\n      setGame(Chess(getSelectedFen()));\n    }\n  } // selects next move in the move history\n\n\n  function selectNextMove() {\n    const [round, side] = selectedMoveIndex;\n    if (side === 0) selectMove(round, 1);else selectMove(round + 1, 0);\n  } // selects previous move in the move history\n\n\n  function selectPreviousMove() {\n    const [round, side] = selectedMoveIndex;\n    if (side === 1) selectMove(round, 0);else selectMove(round - 1, 1);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"hstack gap-3\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"vstack gap-2\",\n      style: {\n        width: size,\n        height: size\n      },\n      children: [/*#__PURE__*/_jsxDEV(Chessboard, {\n        onPieceDrop: legalMoves ? onPieceDrop : undefined,\n        position: getSelectedFen(),\n        customPieces: getPieceStyle(pieceStyle),\n        customBoardStyle: {\n          borderRadius: '7px'\n        },\n        boardWidth: size,\n        animationDuration: 100\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this), showHistoryButtons && /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"history-buttons-div\",\n        className: \"btn-group d-flex justify-content-between\",\n        role: \"group\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: selectPreviousMove,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-caret-left-fill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: selectNextMove,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-caret-right-fill\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }, this), showHistory && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: size * 0.65,\n        minHeight: size,\n        maxHeight: size,\n        overflowY: 'scroll',\n        overflowX: 'hidden'\n      },\n      children: /*#__PURE__*/_jsxDEV(MoveHistory, {\n        pgn: gamePgn,\n        selectedMoveKey: getSelectedMove(),\n        onMoveClicked: (round, side) => selectMove(round, side)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 9\n  }, this);\n};\n\n_s(LionChessboard, \"3886UneIGqlijq3HLKz2YbHOCEM=\");\n\n_c = LionChessboard;\nexport default LionChessboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"LionChessboard\");","map":{"version":3,"sources":["/home/mario/Desktop/ChessLion/client/src/views/components/board/lionChessboard.tsx"],"names":["React","useState","Chessboard","Chess","getPieceStyle","MoveHistory","Pgn","generateFensFromPgn","pgn","fen","game","result","move","moves","round","m","undefined","push","LionChessboard","legalMoves","pieceStyle","showHistory","showHistoryButtons","size","setGame","gamePgn","setGamePgn","selectedMoveIndex","setSelectedMoveIndex","onPieceDrop","square1","square2","from","to","promotion","addMove","san","selectNextMove","getSelectedMove","side","getSelectedFen","fens","selectMove","length","selectPreviousMove","width","height","borderRadius","minHeight","maxHeight","overflowY","overflowX"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport Chess, { Square } from 'chess.js';\nimport { getPieceStyle, PieceStyle } from './style';\nimport MoveHistory from './history';\nimport Pgn, { PgnObject } from '../../../utils/pgn/pgnParser';\nimport './lionChessboard.scss';\n\n\nfunction generateFensFromPgn(pgn: PgnObject, fen?: string): Array<[string, string]> {\n    // @ts-ignore\n    const game = Chess(fen);\n    const result: Array<[string, string]> = [];\n    for (let move of pgn.moves) {\n        const round: [string, string] = ['', ''];\n        for (let m of move) {\n            if (m.move !== undefined) {\n                game.move(m.move);\n                round.push(game.fen());\n            }\n        }\n        result.push(round);\n    }\n    return result;\n}\n\n/**\n * This interface contains all the props for the 'LionChessboard' component.\n */\nexport interface LionChessboardProps {\n    /** The FEN position of the board */\n    fen?: string;\n    /** Whether only legal moves should be allowed */\n    legalMoves?: boolean;\n    /** The style of the pieces */\n    pieceStyle?: PieceStyle;\n    /** Whether to show the move history */\n    showHistory?: boolean;\n    /** Whether to show the 'next move' and 'previous move' buttons for the move history */\n    showHistoryButtons?: boolean;\n    /** An optional PGN game */\n    pgn?: string;\n    /** The size of the board in pixels */\n    size?: number;\n}\n\n/**\n * This component displays a chessboard. For info about the props, refer to the\n * interface 'LionCHessboardProps'.\n * @param {LionChessboardProps} props The props for the chessboard\n * @returns The JSX that display the chessboard\n */\nconst LionChessboard: React.FC<LionChessboardProps> = ({\n        legalMoves = true,\n        fen = 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1',\n        pieceStyle = 'fresca',\n        showHistory = false,\n        showHistoryButtons = false,\n        pgn = undefined,\n        size = 500,\n    }: LionChessboardProps) => {\n\n    // @ts-ignore\n    const [game, setGame] = useState( Chess(fen) );\n    const [gamePgn, setGamePgn] = useState<Pgn>( new Pgn(pgn) );\n    const [selectedMoveIndex, setSelectedMoveIndex] = useState<[number, 0 | 1]>([-1, 1]);\n\n    // legal moves only\n    function onPieceDrop(square1: Square, square2: Square): boolean {\n        let move = game.move({ from: square1, to: square2, promotion: 'q' });\n        if (move !== null) {\n            setGame({...game})\n            gamePgn.addMove({ move: move.san });\n            setGamePgn({...gamePgn})\n            selectNextMove();\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    // gets the key of the currently selected move in the move history\n    function getSelectedMove(): string {\n        const [round, side] = selectedMoveIndex;\n        return (round + 1) + (side===0? 'w' : 'b');\n    }\n\n    function getSelectedFen(): string {\n        const [round, side] = selectedMoveIndex;\n        if (round === -1)\n            return fen;\n        const fens = generateFensFromPgn(gamePgn, fen);\n        return fens[round][side];\n    }\n\n    function selectMove(round: number, side: 0 | 1): void {\n        if (round >= 0 && round < gamePgn.moves.length) {\n            setSelectedMoveIndex([round, side]);\n            // @ts-ignore\n            setGame( Chess(getSelectedFen()) );\n        }\n    }\n\n    // selects next move in the move history\n    function selectNextMove(): void {\n        const [round, side] = selectedMoveIndex;\n        if (side === 0)\n            selectMove(round, 1);\n        else\n            selectMove(round + 1, 0);\n    }\n\n    // selects previous move in the move history\n    function selectPreviousMove(): void {\n        const [round, side] = selectedMoveIndex;\n        if (side === 1)\n            selectMove(round, 0);\n        else\n            selectMove(round - 1, 1);\n    }\n\n    return (\n        <div className=\"hstack gap-3\">\n            <div className=\"vstack gap-2\" style={{width: size, height: size}}>\n                <Chessboard\n                onPieceDrop={ legalMoves? onPieceDrop : undefined }\n                position={ getSelectedFen() }\n                customPieces={ getPieceStyle(pieceStyle) }\n                customBoardStyle={{borderRadius: '7px'}}\n                boardWidth={size}\n                animationDuration={100}\n                />\n                {\n                    showHistoryButtons &&\n                    <div id=\"history-buttons-div\" className=\"btn-group d-flex justify-content-between\" role=\"group\">\n                        <button className=\"btn\" onClick={selectPreviousMove}>\n                            <i className=\"bi bi-caret-left-fill\"></i>\n                        </button>\n                        <button className=\"btn\" onClick={selectNextMove}>\n                            <i className=\"bi bi-caret-right-fill\"></i>\n                        </button>\n                    </div>\n                }\n            </div>\n            {\n                showHistory &&\n                <div style={{\n                    width: size * 0.65,\n                    minHeight: size,\n                    maxHeight: size,\n                    overflowY: 'scroll',\n                    overflowX: 'hidden',\n                }}>\n                    <MoveHistory\n                    pgn={gamePgn}\n                    selectedMoveKey={getSelectedMove()}\n                    onMoveClicked={(round, side) => selectMove(round, side)}\n                    />\n                </div>\n            }\n        </div>\n    );\n}\n\nexport default LionChessboard;\n"]},"metadata":{},"sourceType":"module"}